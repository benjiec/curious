<p ng-if="search_error">
  <span class="label label-danger">Search Error</span>
  {{ search_error }}
</p>

<p ng-if="completed && success && !last_model">
  <em>No matching data</em>
</p>

<div ng-if="completed && success && last_model">

<div id="results-header">
  <span>{{ table.rows.length }} row(s) of <b>{{ last_model }}</b></span>
  <div id="recommended_rels" class="dropdown navbar-right">
    <a data-toggle="dropdown" href="javascript:void(0);">Relations from {{ last_model }}</a>
    <ul class="rel-list dropdown-menu" role="menu">
      <li ng-repeat="rel in last_model_rels">
        <span class="rel-actions">
          <a class="btn btn-xs btn-info" href='javascript:void(0);' title="Extend query"
             ng-click="extendQuery(last_model, rel)">Q</a>
        </span>
        <span class="rel-name">{{ rel }}</span>
      </li>
    </ul>
  </div> <!-- recommended_rels -->
</div>

<table class="table table-condensed table-striped table-bordered table-fixed" ng-if="table.attrs">
  <tr class="success">
    <td class="wrap" ng-repeat="q in table.queries track by $index" colspan="{{ q.cols }}">
      <a href="javascript:void(0)" ng-click="table.toggle($index)" title="Click to show/hide attrs"
       >{{ q.model }}</a>
    </td>
  </tr>

  <tr class="success">
    <th class="wrap" ng-repeat="attr in table.attrs track by $index">{{ attr }}</th>
  </tr>

  <tr ng-repeat="row in table.rows track by $index">
    <td class="wrap" ng-repeat="object in row track by $index">
      <span ng-bind-html="object.ptr[table.attrs[$index]]|showAttr"></span>
    </td>
  </tr>
</table>

<p ng-if="!table.csv">
  <a href="javascript:void(0)" ng-click="table.showCSV()">Show CSV</a>
</p>
<textarea class="csv" ng-if="table.csv" readonly>{{ table.csv }}</textarea>

</div> <!-- if for results table -->
